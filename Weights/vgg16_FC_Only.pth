{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"vgg16_FC_Only.pth","provenance":[],"collapsed_sections":[],"machine_shape":"hm","authorship_tag":"ABX9TyOLp65PCdaqM/HhEbJp5nDM"},"kernelspec":{"name":"python3","display_name":"Python 3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"acb22a59885a4e82861635294adae5e3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7d396052fb2d4e06b909e93d1b212206","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_459cf1512acb44289c01cf55a890eade","IPY_MODEL_9d25414b55d54cae8a19fced5ae9f0eb"]}},"7d396052fb2d4e06b909e93d1b212206":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"459cf1512acb44289c01cf55a890eade":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e6180eca248d4092979e20463d4a468e","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":553433881,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":553433881,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0995e34ba58748e8bf2550fb9f6b4f3d"}},"9d25414b55d54cae8a19fced5ae9f0eb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ac32d9386c7e4df4b8909bc1f454de88","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 528M/528M [00:09&lt;00:00, 58.9MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c7279cc2f3774481ac9bb0e9c89610b0"}},"e6180eca248d4092979e20463d4a468e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0995e34ba58748e8bf2550fb9f6b4f3d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ac32d9386c7e4df4b8909bc1f454de88":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c7279cc2f3774481ac9bb0e9c89610b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}},"accelerator":"GPU"},"cells":[{"cell_type":"code","metadata":{"id":"CBRuMnXdYsMo","colab_type":"code","colab":{}},"source":["import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","from torch.optim import lr_scheduler\n","from torch.autograd import Variable\n","import numpy as np\n","import torchvision\n","from torchvision import datasets, models, transforms\n","import matplotlib.pyplot as plt\n","import time\n","import os\n","import copy\n","import scikitplot as skplt"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"r6J9xGFgYwU_","colab_type":"code","outputId":"968bac0b-4377-4854-a9b1-72815ce15e35","executionInfo":{"status":"ok","timestamp":1587716888547,"user_tz":-300,"elapsed":26793,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":121}},"source":["from google.colab import drive\n","drive.mount('/content/gdrive')"],"execution_count":0,"outputs":[{"output_type":"stream","text":["Go to this URL in a browser: https://accounts.google.com/o/oauth2/auth?client_id=947318989803-6bn6qk8qdgf4n4g3pfee6491hc0brc4i.apps.googleusercontent.com&redirect_uri=urn%3aietf%3awg%3aoauth%3a2.0%3aoob&response_type=code&scope=email%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdocs.test%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive.photos.readonly%20https%3a%2f%2fwww.googleapis.com%2fauth%2fpeopleapi.readonly\n","\n","Enter your authorization code:\n","··········\n","Mounted at /content/gdrive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"f_qLcNlXY9d5","colab_type":"code","outputId":"51a20a97-02f8-42c3-ee2c-a61695395367","executionInfo":{"status":"ok","timestamp":1587716892762,"user_tz":-300,"elapsed":3496,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["data_dir= '/content/gdrive/\"My Drive\"/Assignment_5_Dataset'\n","!ls {data_dir}"],"execution_count":0,"outputs":[{"output_type":"stream","text":["test  train  validation\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"nz2Hq3axaZ16","colab_type":"code","outputId":"4d1c090a-19f6-4bfa-d9a1-c1febfa8a9be","executionInfo":{"status":"ok","timestamp":1587716919433,"user_tz":-300,"elapsed":24963,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":50}},"source":["#Define transforms for the training data and testing data\n","train_transforms = transforms.Compose([transforms.RandomRotation(0),\n","                                       transforms.RandomResizedCrop(1024),\n","                                       transforms.RandomHorizontalFlip(),\n","                                       transforms.ToTensor(),\n","                                       transforms.Normalize([0.485, 0.456, 0.406],\n","                                                            [0.229, 0.224, 0.225])])\n","\n","test_transforms = transforms.Compose([transforms.Resize(256),\n","                                      transforms.CenterCrop(1024),\n","                                      transforms.ToTensor(),\n","                                      transforms.Normalize([0.485, 0.456, 0.406],\n","                                                           [0.229, 0.224, 0.225])])\n","\n","val_transforms = transforms.Compose([transforms.Resize(256),\n","                                      transforms.CenterCrop(1024),\n","                                      transforms.ToTensor(),\n","                                      transforms.Normalize([0.485, 0.456, 0.406],\n","                                                           [0.229, 0.224, 0.225])])\n","\n","#pass transform here-in\n","train_data = datasets.ImageFolder(root= \"/content/gdrive/My Drive/Assignment_5_Dataset/train\", transform=train_transforms)\n","test_data = datasets.ImageFolder(root= \"/content/gdrive/My Drive/Assignment_5_Dataset/test\", transform=test_transforms)\n","val_data = datasets.ImageFolder(root= \"/content/gdrive/My Drive/Assignment_5_Dataset/validation\", transform=val_transforms)\n","#train_data = datasets.ImageFolder(data_dir + '/train-set', transform=train_transforms)\n","#test_data = datasets.ImageFolder(data_dir + '/val-set', transform=test_transforms)\n","\n","#data loaders\n","trainloader = torch.utils.data.DataLoader(train_data, batch_size=8, shuffle=True)\n","testloader = torch.utils.data.DataLoader(test_data, batch_size=8, shuffle=True)\n","valloader = torch.utils.data.DataLoader(val_data, batch_size=8, shuffle=True)\n","                                          \n","print(\"Classes: \")\n","class_names = train_data.classes\n","print(class_names)"],"execution_count":0,"outputs":[{"output_type":"stream","text":["Classes: \n","['infected', 'normal']\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"jMimMt8bfBiH","colab_type":"code","outputId":"9fa3c93f-3a15-4e4a-92cd-09fc06602f65","executionInfo":{"status":"ok","timestamp":1587716925093,"user_tz":-300,"elapsed":25944,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":106}},"source":["def imshow(inp, title=None):\n","    inp = inp.numpy().transpose((1, 2, 0))\n","    plt.axis('off')\n","    plt.imshow(inp)\n","    if title is not None:\n","        plt.title(title)\n","    plt.pause(0.001)\n","\n","def show_databatch(inputs, classes):\n","    out = torchvision.utils.make_grid(inputs)\n","    imshow(out, title=[class_names[x] for x in classes])\n","\n","# Get a batch of training data\n","inputs, classes = next(iter(trainloader))\n","show_databatch(inputs, classes)"],"execution_count":0,"outputs":[{"output_type":"stream","text":["Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"],"name":"stderr"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"YKGfleTWfctW","colab_type":"text"},"source":["Load pre-trained VGG-16"]},{"cell_type":"code","metadata":{"id":"0T4ICQDKfdU_","colab_type":"code","outputId":"1fd40cfd-4528-4c29-cb0d-328dc31941e6","executionInfo":{"status":"ok","timestamp":1587716935694,"user_tz":-300,"elapsed":21654,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":855,"referenced_widgets":["acb22a59885a4e82861635294adae5e3","7d396052fb2d4e06b909e93d1b212206","459cf1512acb44289c01cf55a890eade","9d25414b55d54cae8a19fced5ae9f0eb","e6180eca248d4092979e20463d4a468e","0995e34ba58748e8bf2550fb9f6b4f3d","ac32d9386c7e4df4b8909bc1f454de88","c7279cc2f3774481ac9bb0e9c89610b0"]}},"source":["# Load the pretrained model from pytorch\n","vgg16 = models.vgg16(pretrained=True)\n","print(vgg16)\n","print('Output Layer of VGG16 : ', vgg16.classifier[6].out_features) # 1000 "],"execution_count":0,"outputs":[{"output_type":"stream","text":["Downloading: \"https://download.pytorch.org/models/vgg16-397923af.pth\" to /root/.cache/torch/checkpoints/vgg16-397923af.pth\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"acb22a59885a4e82861635294adae5e3","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=553433881), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","VGG(\n","  (features): Sequential(\n","    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (1): ReLU(inplace=True)\n","    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (3): ReLU(inplace=True)\n","    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (6): ReLU(inplace=True)\n","    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (8): ReLU(inplace=True)\n","    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (11): ReLU(inplace=True)\n","    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (13): ReLU(inplace=True)\n","    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (15): ReLU(inplace=True)\n","    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (18): ReLU(inplace=True)\n","    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (20): ReLU(inplace=True)\n","    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (22): ReLU(inplace=True)\n","    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (25): ReLU(inplace=True)\n","    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (27): ReLU(inplace=True)\n","    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (29): ReLU(inplace=True)\n","    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","  )\n","  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))\n","  (classifier): Sequential(\n","    (0): Linear(in_features=25088, out_features=4096, bias=True)\n","    (1): ReLU(inplace=True)\n","    (2): Dropout(p=0.5, inplace=False)\n","    (3): Linear(in_features=4096, out_features=4096, bias=True)\n","    (4): ReLU(inplace=True)\n","    (5): Dropout(p=0.5, inplace=False)\n","    (6): Linear(in_features=4096, out_features=1000, bias=True)\n","  )\n",")\n","Output Layer of VGG16 :  1000\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"q3QeEBQdfvyf","colab_type":"code","outputId":"6ffe7333-0257-4499-f192-7c4f306522da","executionInfo":{"status":"ok","timestamp":1587716935697,"user_tz":-300,"elapsed":13374,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(vgg16.classifier[5])"],"execution_count":0,"outputs":[{"output_type":"stream","text":["Dropout(p=0.5, inplace=False)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"WzYRbq9GgLeg","colab_type":"text"},"source":["Removing Last Layer"]},{"cell_type":"code","metadata":{"id":"se6yUNGyf25L","colab_type":"code","outputId":"b8798e7c-b429-47bf-b6b3-b56ae22701b4","executionInfo":{"status":"ok","timestamp":1587716941677,"user_tz":-300,"elapsed":1079,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["num_features = vgg16.classifier[0].in_features\n","features = list(vgg16.classifier.children())[:-7] # Remove last layer\n","print(features)"],"execution_count":0,"outputs":[{"output_type":"stream","text":["[]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"zAT5aRVOgcw8","colab_type":"text"},"source":["Freezing the layers"]},{"cell_type":"code","metadata":{"id":"NNsHQGRSghxa","colab_type":"code","colab":{}},"source":["# Freeze training for all layers\n","for param in vgg16.features.parameters():\n","    param.requires_grad = False"],"execution_count":0,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"tCQ35hzDgKVO","colab_type":"text"},"source":["Adding new layers"]},{"cell_type":"code","metadata":{"id":"nawm2YCgghEZ","colab_type":"code","colab":{}},"source":["features.extend([nn.Linear(num_features, 130)])"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"1-qnJihCVH9t","colab_type":"code","colab":{}},"source":["features.extend([nn.Linear(130, 2)])"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"qoxPJw4WA-vN","colab_type":"code","outputId":"1cc8ee78-c46b-4319-da06-2ba701586513","executionInfo":{"status":"ok","timestamp":1587716953138,"user_tz":-300,"elapsed":700,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(features)"],"execution_count":0,"outputs":[{"output_type":"stream","text":["[Linear(in_features=25088, out_features=130, bias=True), Linear(in_features=130, out_features=1000, bias=True)]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"at_TzkKVgqWv","colab_type":"code","outputId":"8496375b-119f-4d01-d6ff-3e09be3d9829","executionInfo":{"status":"ok","timestamp":1587716958121,"user_tz":-300,"elapsed":1016,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":689}},"source":["vgg16.classifier = nn.Sequential(*features)\n","print(vgg16)"],"execution_count":0,"outputs":[{"output_type":"stream","text":["VGG(\n","  (features): Sequential(\n","    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (1): ReLU(inplace=True)\n","    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (3): ReLU(inplace=True)\n","    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (6): ReLU(inplace=True)\n","    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (8): ReLU(inplace=True)\n","    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (11): ReLU(inplace=True)\n","    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (13): ReLU(inplace=True)\n","    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (15): ReLU(inplace=True)\n","    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (18): ReLU(inplace=True)\n","    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (20): ReLU(inplace=True)\n","    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (22): ReLU(inplace=True)\n","    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (25): ReLU(inplace=True)\n","    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (27): ReLU(inplace=True)\n","    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))\n","    (29): ReLU(inplace=True)\n","    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)\n","  )\n","  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))\n","  (classifier): Sequential(\n","    (0): Linear(in_features=25088, out_features=130, bias=True)\n","    (1): Linear(in_features=130, out_features=1000, bias=True)\n","  )\n",")\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"2iq-0IIug2GP","colab_type":"text"},"source":["Loss function And Optimizer "]},{"cell_type":"code","metadata":{"id":"qBemDti1gu7N","colab_type":"code","colab":{}},"source":["Epochs = 10\n","criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(vgg16.parameters(), lr=0.01, momentum=0.9)"],"execution_count":0,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"CCqLWh0HhFzj","colab_type":"text"},"source":["Training"]},{"cell_type":"code","metadata":{"id":"f4H-3hzUg6H1","colab_type":"code","outputId":"a726182e-3771-4ca1-bd94-3d9416ddf3f7","executionInfo":{"status":"error","timestamp":1587717247604,"user_tz":-300,"elapsed":281369,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":387}},"source":["from tqdm import tqdm\n","\n","#if you have gpu then you need to convert the network and data to cuda\n","#the easiest way is to first check for device and then convert network and data to device\n","device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","vgg16.to(device)\n","\n","vgg16.train()\n","\n","for epoch in range(Epochs):  # loop over the dataset multiple times\n","\n","    running_loss = 0.0\n","    pbar = tqdm(enumerate(trainloader))\n","    for i, data in pbar:\n","        # get the inputs\n","        inputs, labels = data\n","        inputs, labels = inputs.to(device), labels.to(device)\n","\n","        # zero the parameter gradients\n","        optimizer.zero_grad()\n","        # In PyTorch, we need to set the gradients to zero before starting to do backpropragation \n","        # because PyTorch accumulates the gradients on subsequent backward passes. \n","        # This is convenient while training RNNs. \n","        # So, the default action is to accumulate the gradients on every loss.backward() call\n","\n","        # forward + backward + optimize\n","        outputs = vgg16(inputs)               #----> forward pass\n","        loss = criterion(outputs, labels)   #----> compute loss\n","        loss.backward()                     #----> backward pass\n","        optimizer.step()                    #----> weights update\n","\n","        # print statistics\n","        running_loss += loss.item()\n","        \n","        pbar.set_description(\n","            'Train Epoch: {} [{}/{} ({:.0f}%)]\\tLoss: {:.6f}'.format(\n","                epoch, i * len(inputs), len(trainloader.dataset),\n","                100. * i / len(trainloader),\n","                loss.data))\n","        \n","    torch.save(vgg16.state_dict(), 'vgg16_ft.pth')\n","\n","print('Finished Training')"],"execution_count":0,"outputs":[{"output_type":"stream","text":["Train Epoch: 0 [8/3544 (0%)]\tLoss: 6.186090: : 2it [03:13, 97.80s/it]"],"name":"stderr"},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-17-4bef0d539cf6>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     25\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     26\u001b[0m         \u001b[0;31m# forward + backward + optimize\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 27\u001b[0;31m         \u001b[0moutputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvgg16\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m               \u001b[0;31m#----> forward pass\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     28\u001b[0m         \u001b[0mloss\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcriterion\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m\u001b[0;34m)\u001b[0m   \u001b[0;31m#----> compute loss\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     29\u001b[0m         \u001b[0mloss\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbackward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m                     \u001b[0;31m#----> backward pass\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    530\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    531\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 532\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    533\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mhook\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    534\u001b[0m             \u001b[0mhook_result\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torchvision/models/vgg.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, x)\u001b[0m\n\u001b[1;32m     41\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     42\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 43\u001b[0;31m         \u001b[0mx\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfeatures\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     44\u001b[0m         \u001b[0mx\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mavgpool\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     45\u001b[0m         \u001b[0mx\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflatten\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    530\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    531\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 532\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    533\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mhook\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    534\u001b[0m             \u001b[0mhook_result\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/container.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input)\u001b[0m\n\u001b[1;32m     98\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     99\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mmodule\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 100\u001b[0;31m             \u001b[0minput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    101\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    102\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    530\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    531\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 532\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    533\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mhook\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    534\u001b[0m             \u001b[0mhook_result\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input)\u001b[0m\n\u001b[1;32m    343\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    344\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 345\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconv2d_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mweight\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    346\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    347\u001b[0m \u001b[0;32mclass\u001b[0m \u001b[0mConv3d\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0m_ConvNd\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/conv.py\u001b[0m in \u001b[0;36mconv2d_forward\u001b[0;34m(self, input, weight)\u001b[0m\n\u001b[1;32m    340\u001b[0m                             _pair(0), self.dilation, self.groups)\n\u001b[1;32m    341\u001b[0m         return F.conv2d(input, weight, self.bias, self.stride,\n\u001b[0;32m--> 342\u001b[0;31m                         self.padding, self.dilation, self.groups)\n\u001b[0m\u001b[1;32m    343\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    344\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","metadata":{"id":"6C092TdRb28i","colab_type":"code","colab":{}},"source":["acc=[]\n","correct = 0\n","total = 0\n","with torch.no_grad():\n","    for k in range(Epochs):\n","        for data in trainloader:\n","            images, labels = data\n","            images, labels = images.to(device), labels.to(device)\n","            outputs = vgg16(images)\n","            _, predicted = torch.max(outputs.data, 1)\n","            total += labels.size(0)\n","            correct += (predicted == labels).sum().item()\n","        acc.append(100*correct/total)\n","\n","print('Accuracy of the network on Training images: %d %%' % (\n","    100 * correct / total))\n","epocharray=range(0,Epochs)\n","plt.plot(epocharray,acc)\n","plt.ylabel('Training Accuracy')\n","plt.xlabel('Epochs')"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"aJl7fz5BcHiF","colab_type":"code","colab":{}},"source":["#Confusion Matrix Part\n","nb_classes = 2\n","\n","confusion_matrix = torch.zeros(nb_classes, nb_classes)\n","with torch.no_grad():\n","    for i, (inputs, classes) in enumerate(trainloader):\n","        inputs = inputs.to(device)\n","        classes = classes.to(device)\n","        outputs = vgg16(inputs)\n","        _, preds = torch.max(outputs, 1)\n","        for t, p in zip(classes.view(-1), preds.view(-1)):\n","                confusion_matrix[t.long(), p.long()] += 1\n","\n","print(confusion_matrix)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"uJ5YwAk8cJ6q","colab_type":"code","colab":{}},"source":["print(confusion_matrix.diag()/confusion_matrix.sum(1))"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"NG3Qmiw2cPxg","colab_type":"code","colab":{}},"source":["skplt.metrics.plot_confusion_matrix(classes, preds, figsize=(4,4), normalize=True)\n","plt.show()"],"execution_count":0,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"d-leTaIecW8o","colab_type":"text"},"source":["Test Part"]},{"cell_type":"code","metadata":{"id":"jurLJlc65BEI","colab_type":"code","colab":{}},"source":["dataiter = iter(testloader)\n","images, labels = dataiter.next()\n","show_databatch(images, labels)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"vXGLVERl81G7","colab_type":"code","colab":{}},"source":["images, labels = images.to(device), labels.to(device) #-->convert test image to cuda (if available)\n","outputs = vgg16(images)                               #--> forward pass\n","_, predicted = torch.max(outputs, 1)\n","\n","print('Predicted: ', ' '.join('%5s' % class_names[predicted[j]]\n","                              for j in range(len(images))))\n","print('Ground Truth: ', ' '.join('%5s' % class_names[labels[j]]\n","                              for j in range(len(images))))"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"sBT9fBJyrwBE","colab_type":"code","outputId":"6f93399d-32d5-4716-e8ee-949af0c6b975","executionInfo":{"status":"error","timestamp":1587714971103,"user_tz":-300,"elapsed":249841,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":370}},"source":["correct = 0\n","total = 0\n","acc=[]\n","with torch.no_grad():\n","    for k in range(Epochs):\n","        for data in testloader:\n","            images, labels = data\n","            images, labels = images.to(device), labels.to(device)\n","            outputs = vgg16(images)\n","            _, predicted = torch.max(outputs.data, 1)\n","            total += labels.size(0)\n","            correct += (predicted == labels).sum().item()\n","        acc.append(100*correct/total)\n","        \n","\n","print('Accuracy of the network on test images: %d %%' % (\n","    100 * correct / total))\n","\n","epocharray=range(0,Epochs)\n","plt.plot(epocharray,acc)\n","plt.ylabel('Test Accuracy')\n","plt.xlabel('Epochs')\n","    "],"execution_count":0,"outputs":[{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-16-db0b95d93604>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mtotal\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;32mwith\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mno_grad\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m     \u001b[0;32mfor\u001b[0m \u001b[0mdata\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mtestloader\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m         \u001b[0mimages\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m         \u001b[0mimages\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mimages\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py\u001b[0m in \u001b[0;36m__next__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    343\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    344\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__next__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 345\u001b[0;31m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_next_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    346\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_num_yielded\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    347\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dataset_kind\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0m_DatasetKind\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mIterable\u001b[0m \u001b[0;32mand\u001b[0m\u001b[0;31m \u001b[0m\u001b[0;31m\\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py\u001b[0m in \u001b[0;36m_next_data\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    383\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_next_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    384\u001b[0m         \u001b[0mindex\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_next_index\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# may raise StopIteration\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 385\u001b[0;31m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dataset_fetcher\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfetch\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mindex\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# may raise StopIteration\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    386\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_pin_memory\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    387\u001b[0m             \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_utils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpin_memory\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpin_memory\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py\u001b[0m in \u001b[0;36mfetch\u001b[0;34m(self, possibly_batched_index)\u001b[0m\n\u001b[1;32m     42\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfetch\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     43\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauto_collation\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 44\u001b[0;31m             \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0midx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     45\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     46\u001b[0m             \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m     42\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mfetch\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     43\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauto_collation\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 44\u001b[0;31m             \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0midx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     45\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     46\u001b[0m             \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mpossibly_batched_index\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torchvision/datasets/folder.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, index)\u001b[0m\n\u001b[1;32m    136\u001b[0m         \"\"\"\n\u001b[1;32m    137\u001b[0m         \u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtarget\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msamples\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mindex\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 138\u001b[0;31m         \u001b[0msample\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloader\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    139\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtransform\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    140\u001b[0m             \u001b[0msample\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtransform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msample\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torchvision/datasets/folder.py\u001b[0m in \u001b[0;36mdefault_loader\u001b[0;34m(path)\u001b[0m\n\u001b[1;32m    172\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0maccimage_loader\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    173\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 174\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mpil_loader\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    175\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    176\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torchvision/datasets/folder.py\u001b[0m in \u001b[0;36mpil_loader\u001b[0;34m(path)\u001b[0m\n\u001b[1;32m    154\u001b[0m     \u001b[0;31m# open path as file to avoid ResourceWarning (https://github.com/python-pillow/Pillow/issues/835)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    155\u001b[0m     \u001b[0;32mwith\u001b[0m \u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'rb'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mf\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 156\u001b[0;31m         \u001b[0mimg\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mImage\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    157\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mimg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconvert\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'RGB'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    158\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/PIL/Image.py\u001b[0m in \u001b[0;36mopen\u001b[0;34m(fp, mode)\u001b[0m\n\u001b[1;32m   2816\u001b[0m         \u001b[0mexclusive_fp\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2817\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2818\u001b[0;31m     \u001b[0mprefix\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m16\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2819\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2820\u001b[0m     \u001b[0mpreinit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","metadata":{"id":"ffxsKigFckab","colab_type":"code","colab":{}},"source":["nb_classes = 2\n","\n","confusion_matrix = torch.zeros(nb_classes, nb_classes)\n","with torch.no_grad():\n","    for i, (inputs, classes) in enumerate(testloader):\n","        inputs = inputs.to(device)\n","        classes = classes.to(device)\n","        outputs = vgg16(inputs)\n","        _, preds = torch.max(outputs, 1)\n","        for t, p in zip(classes.view(-1), preds.view(-1)):\n","                confusion_matrix[t.long(), p.long()] += 1\n","\n","print(confusion_matrix)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"FrALXwbDcpE6","colab_type":"code","colab":{}},"source":["print(confusion_matrix.diag()/confusion_matrix.sum(1))"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"mqEo7KidcsLK","colab_type":"code","colab":{}},"source":["skplt.metrics.plot_confusion_matrix(classes, preds, figsize=(4,4), normalize=True)\n","plt.show()"],"execution_count":0,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"9aPmwu7zc09B","colab_type":"text"},"source":["Valition Part"]},{"cell_type":"code","metadata":{"id":"mhAWxYOZrXAy","colab_type":"code","colab":{}},"source":["dataiter = iter(valloader)\n","images, labels = dataiter.next()\n","show_databatch(images, labels)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"RHnQbNJurdyV","colab_type":"code","outputId":"3e65d78e-57a5-4a64-e15a-d9513078df1c","executionInfo":{"status":"error","timestamp":1587686464071,"user_tz":-300,"elapsed":13543291,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":229}},"source":["images, labels = images.to(device), labels.to(device) #-->convert test image to cuda (if available)\n","outputs = vgg16(images)                               #--> forward pass\n","_, predicted = torch.max(outputs, 1)\n","\n","print('Predicted: ', ' '.join('%5s' % class_names[predicted[j]]\n","                              for j in range(len(images))))\n","print('Ground Truth: ', ' '.join('%5s' % class_names[labels[j]]\n","                              for j in range(len(images))))"],"execution_count":0,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-18-8ea866da5f06>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mimages\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mimages\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabels\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m#-->convert test image to cuda (if available)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0moutputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvgg16\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mimages\u001b[0m\u001b[0;34m)\u001b[0m                               \u001b[0;31m#--> forward pass\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0m_\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpredicted\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m print('Predicted: ', ' '.join('%5s' % class_names[predicted[j]]\n","\u001b[0;31mNameError\u001b[0m: name 'images' is not defined"]}]},{"cell_type":"code","metadata":{"id":"lK6qxrvOrkDK","colab_type":"code","colab":{}},"source":["acc=[]\n","correct = 0\n","total = 0\n","with torch.no_grad():\n","    for k in range(Epochs):\n","        for data in valloader:\n","            images, labels = data\n","            images, labels = images.to(device), labels.to(device)\n","            outputs = vgg16(images)\n","            _, predicted = torch.max(outputs.data, 1)\n","            total += labels.size(0)\n","            correct += (predicted == labels).sum().item()\n","        acc.append(100*correct/total)\n","\n","print('Accuracy of the network on Validation images: %d %%' % (\n","    100 * correct / total))\n","epocharray=range(0,Epochs)\n","plt.plot(epocharray,acc)\n","plt.ylabel('Validation Accuracy')\n","plt.xlabel('Epochs')"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"wp2XvKrOc-tU","colab_type":"code","colab":{}},"source":["nb_classes = 2\n","\n","confusion_matrix = torch.zeros(nb_classes, nb_classes)\n","with torch.no_grad():\n","    for i, (inputs, classes) in enumerate(valloader):\n","        inputs = inputs.to(device)\n","        classes = classes.to(device)\n","        outputs = vgg16(inputs)\n","        _, preds = torch.max(outputs, 1)\n","        for t, p in zip(classes.view(-1), preds.view(-1)):\n","                confusion_matrix[t.long(), p.long()] += 1\n","\n","print(confusion_matrix)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"St4ghe4FdDx7","colab_type":"code","colab":{}},"source":["print(confusion_matrix.diag()/confusion_matrix.sum(1))"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"RaPqnMOedJjr","colab_type":"code","colab":{}},"source":["skplt.metrics.plot_confusion_matrix(classes, preds, figsize=(4,4), normalize=True)\n","plt.show()\n"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"1fzgkWMYGYYl","colab_type":"code","outputId":"f2a73b25-6202-49b8-8a8b-3cfd99a34940","executionInfo":{"status":"ok","timestamp":1587667591086,"user_tz":-300,"elapsed":1385,"user":{"displayName":"Sumbel Ijaz","photoUrl":"","userId":"00580099440721405135"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["torch.cuda.get_device_name()"],"execution_count":0,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'Tesla P100-PCIE-16GB'"]},"metadata":{"tags":[]},"execution_count":80}]},{"cell_type":"code","metadata":{"id":"kS_PdmiKhK0l","colab_type":"code","colab":{}},"source":[""],"execution_count":0,"outputs":[]}]}